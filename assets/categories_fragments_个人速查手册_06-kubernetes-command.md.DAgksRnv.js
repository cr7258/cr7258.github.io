import{_ as h}from"./chunks/ArticleMetadata.CAxLmLz2.js";import{_ as k,C as d,c as o,o as t,k as n,G as r,P as F,a as g,w as c,b as y,e as C}from"./chunks/framework.kLAB-UjF.js";import"./chunks/md5.CeBdha7O.js";const _=JSON.parse('{"title":"Kubernetes 常用命令","description":"","frontmatter":{"title":"Kubernetes 常用命令","author":"Se7en","date":"2025/03/25 16:00","categories":["个人速查手册"],"tags":["Kubernetes"]},"headers":[],"relativePath":"categories/fragments/个人速查手册/06-kubernetes-command.md","filePath":"categories/fragments/个人速查手册/06-kubernetes-command.md","lastUpdated":1742892757000}'),u={name:"categories/fragments/个人速查手册/06-kubernetes-command.md"};function D(i,s,m,b,A,v){const p=h,l=d("ClientOnly");return t(),o("div",null,[s[0]||(s[0]=n("h1",{id:"kubernetes-常用命令",tabindex:"-1"},[g("Kubernetes 常用命令 "),n("a",{class:"header-anchor",href:"#kubernetes-常用命令","aria-label":'Permalink to "Kubernetes 常用命令"'},"​")],-1)),r(l,null,{default:c(()=>{var a,e;return[(((a=i.$frontmatter)==null?void 0:a.aside)??!0)&&(((e=i.$frontmatter)==null?void 0:e.showArticleMetadata)??!0)?(t(),y(p,{key:0,article:i.$frontmatter},null,8,["article"])):C("",!0)]}),_:1}),s[1]||(s[1]=F(`<h2 id="找出-daemonset-在哪些-node-上没有成功创建-pod" tabindex="-1">找出 DaemonSet 在哪些 node 上没有成功创建 Pod <a class="header-anchor" href="#找出-daemonset-在哪些-node-上没有成功创建-pod" aria-label="Permalink to &quot;找出 DaemonSet 在哪些 node 上没有成功创建 Pod&quot;">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> DAEMONSET_NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;kube-proxy-cpu-worker-b-v1.30.8&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> nodes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;"> egrep</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -v</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> $(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> get pods </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">-o</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> wide </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;"> grep</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> $DAEMONSET_NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;"> awk</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;{print $7}&#39; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;"> grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -v</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> none </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;"> paste</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -s</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;|&quot; -)</span></span></code></pre></div><p>命令拆解：</p><ol><li><code>kubectl get pods -o wide</code>：列出所有 pod，包括所在 Node 信息。</li></ol><p>输出可能像这样：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">                         READY</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">   STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">    RESTARTS</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">   AGE</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">   IP</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">            NODE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">kube-proxy-xxxx</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">              1</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">/1</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">   0</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">          3</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">d</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    10.0</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">.0.1</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">      ip-192-168-1-1</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">...</span></span></code></pre></div><ol start="2"><li><p><code>grep $DAEMONSET_NAME</code>：只保留和该 DaemonSet 相关的 Pod 行。</p></li><li><p><code>awk &#39;{print $7}&#39;</code>：提取 Pod 所在的 Node 名字（第 7 列是 NODE）。</p></li><li><p><code>grep -v none</code>：排除没有调度成功的 Pod（有时 NODE 显示为 none）。</p></li><li><p><code>paste -s -d&quot;|&quot; -</code>：把所有 Node 名用 <code>|（正则或）</code>拼起来，例如：</p></li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">ip-192-168-1-1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">ip-192-168-1-2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">ip-192-168-1-3</span></span></code></pre></div><ol start="6"><li><p><code>kubectl get nodes</code>：列出所有 Node。</p></li><li><p><code>egrep -v &lt;上面拼出来的正则&gt;</code>：反向匹配，显示那些没有出现在上述 Node 列表中的 Node，也就是没有运行该 DaemonSet Pod 的 Node。</p></li></ol>`,9))])}const B=k(u,[["render",D]]);export{_ as __pageData,B as default};
